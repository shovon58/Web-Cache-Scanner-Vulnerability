# Web-Cache-Vulnerability-Scanner

[![GitHub go.mod Go version](https://img.shields.io/github/go-mod/go-version/Hackmanit/Web-Cache-Vulnerability-Scanner)](https://golang.org/)
[![License](https://img.shields.io/github/license/Hackmanit/Web-Cache-Vulnerability-Scanner)](https://www.apache.org/licenses/LICENSE-2.0)

A fast and versatile CLI scanner for web cache poisoning. 
It supports many different web cache poisoning techniques, can crawl a web site for further URLs to test 
and has procedures to analyze a web cache in order to adapt to it before starting to test for web cache poisoning.

- [Features](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#features)
- [Installation](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#installation)
  - [Option 1: Prebuild binary (Recommended)](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#option-1-prebuild-binary-recommended)
  - [Option 2: Fetch repository using Go](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#option-2-fetch-repository-using-go)
- [Usage](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#usage)
  - [Specify headers, parameters, cookies and more](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#specify-headers-parameters-cookies-and-more)
  - [Generate a JSON report](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#generate-a-json-report)
  - [Crawl for URLs](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#crawl-for-urls)
  - [Use a proxy](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#use-a-proxy)
  - [Throttle or accelerate](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#throttle-or-accelerate)
  - [Further flags](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner#further-flags)

# Features
- Supports 9 web cache poisoning techniques  
  1. Unkeyed header poisoning
  2. Unkeyed parameter poisoning
  3. Parameter cloaking
  4. Fat GET
  5. HTTP response splitting
  6. HTTP request smuggling
  7. HTTP header oversize (HHO)
  8. HTTP meta character (HMC)
  9. HTTP method override (HMO)
- Analyzes web cache before testing and adapts to it
- Generates report in JSON format
- Can crawl websites for further URLs to scan
- Traffic can be routed through a proxy (e.g. Burp Suite)
- Has an option to limit requests per second

# Installation
## Option 1: Prebuild binary (Recommended)
Prebuilt binaries and also 2 wordlists are provided on the [releases page](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner/releases).
## Option 2: Fetch repository using Go 
The repository can be fetched using Go.
```
go get -u https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner
```

# Usage
Two wordlists are needed, in order to test for the first 5 techniques.
One wordlist with header names and one with parameter names.

The only mandatory flag is `-u/--url`.
```
wcvs -u 127.0.0.1
wcvs -u http://127.0.0.1
wcvs -u https://127.0.0.1
wcvs -u file:path/to/url_list
```

## Specify headers, parameters, cookies and more
- `--setcookies/-sc` specifies cookies which shall be added to the request
- `--setheaders/-sh` specifies headers which shall be added to the request
- `--setparameters/-sp` specifies parameters which shall be added to the request. While it is also possible to simply add them to the URL, it might be more useful in some cases to add them via this flag.
- `--post/-post` changes the HTTP method from GET to POST
- `--setbody/-sb` specifies the body which shall be added to the request
- `--contenttype/-ct` specifies the value of the Content-Type header
- `--useragentchrome/-uac` changes the User-Agent from `WebCacheVulnerabilityScanner v{Version-Number}` to `Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36`. While the same can be achieved with e.g. `-sh "Mozilla/5.0 (Windows NT 10.0; Win64; x64) ...`, this flag provides a quicker way.

```
wcvs -u 127.0.0.1 -sc "PHPSESSID=123"
wcvs -u 127.0.0.1 -sc "file:/home/user/Documents/cookies.txt"

wcvs -u 127.0.0.1 -sh "Referer: localhost"
wcvs -u 127.0.0.1 -sh "file:/home/user/Documents/headers.txt"

wcvs -u 127.0.0.1 -sp "admin=true"
wcvs -u 127.0.0.1 -sp "file:/home/user/Documents/parameters.txt"

wcvs -u 127.0.0.1 -post -sb "admin=true"
wcvs -u 127.0.0.1 -post -sb "file:/home/user/Documents/body.txt"

wcvs -u 127.0.0.1 -post -sb "{}" -ct "application/json"

wcvs -u 127.0.0.1 -auc
```

## Generate a JSON report
A JSON report is generated and updated after each scanned URL if the flag `--generatereport/-gr` is set.  
The report is written, just like a log file, into the same directory wcvs gets executed from. In order to change the directory for all outputted files use `--generatepath/-gp`
If HTML special chars shall be encoded in the report, use `--escapejson/-ej`

```
wcvs -u 127.0.0.1 -gr
wcvs -u 127.0.0.1 -gr -ej
wcvs -u 127.0.0.1 -gr -gp /home/user/Documents
wcvs -u 127.0.0.1 -gr -gp /home/user/Documents -ej
```

## Crawl for URLs
In order to crawl for URLs `--recursivity/-r` needs to be set. It specifies how deep the crawler shall go recursivity-wise.  
By default WCVS only crawls for URLs of the same domain. To also crawl for other domains `--recdomains/red` can be used.  
To only crawl URLs which inherit a specific string `--recinclude/-rin` can be used.
`--reclimit/-rl` limits how many URLs are crawled for each recursivity depth.
Also, a list with URLs - which shall not be crawled - can be specified with `--recexclude/-rex`. `--generatecompleted/-gc` can, for example, be used to generate a list with all already tested URLs. If a scan is repeated, but WCVS shall not crawl and test again the same URLs, this list can be specified with `--recexclude/-rex`. 

```
wcvs -u 127.0.0.1 -r 5
wcvs -u 127.0.0.1 -r 5 -red /home/user/Documents/mydomains.txt
wcvs -u 127.0.0.1 -r 5 -rl 2
wcvs -u 127.0.0.1 -r 5 -rex /home/user/Documents/donttest.txt
```

## Use a proxy
To use a proxy a certificate of the proxy in PEM format is needed.  
For example, Burp certificates are in DER format. To convert them the following command can be used: `openssl x509 -inform DER -outform PEM -text -in cacert.der -out certificate.pem`  
The path to the certificate can be specified with `--proxycertpath/-ppath`.  
The default URL for the proxy is `http://127.0.0.1:8080`. In order to change it use `--proxyurl/-purl`. 

```
wcvs -u 127.0.0.1 -ppath /home/user/Documents/certificate.pem
wcvs -u 127.0.0.1 -ppath /home/user/Documents/certificate.pem -purl http://127.0.0.1:8081
```

## Throttle or accelerate
The number of maximum allowed requests per second can be set with `--reqrate/-rr`. By default this number is unrestricted.  
Contrary, the number of requests per second can be increased potentially, if `--threads/-t` is used to increase the number of concurrent threads WCVS utilizes. The default value is 20.

```
wcvs -u 127.0.0.1 -rr 10
wcvs -u 127.0.0.1 -rr 1
wcvs -u 127.0.0.1 -rr 0.5
wcvs -u 127.0.0.1 -t 50
```

## Further flags
WCVS provides more than the beforehand mentioned flags and options. `--help/-h` provides a list each flag, its meaning and how to use it.

```
wcvs -h
```
