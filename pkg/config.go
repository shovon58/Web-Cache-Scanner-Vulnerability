package pkg

import (
	"net/http"
	"net/url"
)

var Config ConfigStruct

type ConfigStruct struct {
	Threads        int
	Recursivity    int
	RecInclude     string
	RecExclude     []string
	Verbosity      int
	DoPost         bool
	ContentType    string
	QuerySeperator string
	CacheBuster    string
	StatusCode     int
	TimeOut        int
	DeclineCookies bool
	Force          bool

	Urls       []string
	Cookies    []string
	Headers    []string
	Parameters []string
	Body       string

	DoTest   string
	DontTest string

	GenerateReport bool
	ReportPath     string
	EscapeJSON     bool

	GenerateCompleted bool
	CompletedPath     string

	ProxyCertPath string
	ProxyURL      string

	HeaderWordlist string
	QueryWordlist  string

	Website WebsiteStruct `json:"-"`
}

type WebsiteStruct struct {
	Headers    http.Header
	Body       string
	Cookies    []*http.Cookie
	Url        *url.URL
	BaseUrlStr string
	Queries    map[string]string
	StatusCode int
	Cache      CacheStruct
	Domain     string
}

type CacheStruct struct {
	Parameter     bool
	ParameterName string
	Header        bool
	HeaderName    string

	HitMissVerbose bool
	HitMissTime    bool

	NoCache   bool
	Indicator string
}

func init() {
}

func ReadConfigFile() ConfigStruct {
	config := ConfigStruct{
		Threads:        0,
		Recursivity:    0,
		Verbosity:      0,
		DoPost:         false,
		ContentType:    "",
		QuerySeperator: "",
		CacheBuster:    "",
		StatusCode:     0,
		TimeOut:        0,
		DeclineCookies: false,
		Urls:           nil,
		Cookies:        nil,
		Headers:        nil,
		Parameters:     nil,
		Body:           "",
		DoTest:         "",
		DontTest:       "",
		ProxyCertPath:  "",
		ProxyURL:       "",
		HeaderWordlist: "",
		QueryWordlist:  "",
		Website: WebsiteStruct{
			Body:       "",
			Cookies:    nil,
			Url:        nil,
			BaseUrlStr: "",
			Queries:    nil,
			StatusCode: 0,
		},
	}

	return config
}
